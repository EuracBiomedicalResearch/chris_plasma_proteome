---
title: "Supplementary Information for: \\textit{...}"
output:
  pdf_document:
    includes:
      in_header: "header.sty"
    toc: true
    toc_depth: 2
---

\setcounter{table}{3}

```{r style, echo = FALSE, results = 'asis', message=FALSE}
knitr::opts_chunk$set(echo = FALSE, warning = FALSE, message = FALSE)
```

# General data overview

## Signal distributions of individual proteins

Distribution of $log_{2}$ transformed signal distributions in the analyzed
samples is shown for each protein.

```{r, results = "asis"}
fls <- dir("images/manuscript/supplement", pattern = "^density",
           full.names = TRUE)

for (i in seq_along(fls)) {
    prot_id <- sub("^density-", "", basename(fls[i]))
    prot_id <- sub(".png", "", prot_id, fixed = TRUE)
    cat("\n\\begin{figure}[H]\n")
    cat("\\centering\n")
    cat("  \\includegraphics[width=0.7\\textwidth]{",
        fls[i], "}\n", sep = "")
    cat("  \\caption{Signal distribution for ", prot_id, ".}\n", sep = "")
    cat("\\end{figure}\n")
    ## cat(paste0("![", met_name[i],".](", met_image[i], ")"), "\n")
    }
```


## Principal Component Analysis and influence of hormonal contraceptive use

```{r, results = "asis"}
cat("\n\\begin{figure}[H]\n")
cat("\\centering\n")
cat("  \\includegraphics[width=0.7\\textwidth]{",
    "images/manuscript/supplement/Figure_S149.png}\n",
    sep = "")
cat("  \\caption{Principal component anaysis of the plasma proteome data. ",
    "Data points are colored according to usage of hormonal contraceptives.}\n",
    sep = "")
cat("\\end{figure}\n")

```

```{r, results = "asis"}
cat("\n\\begin{figure}[H]\n")
cat("\\centering\n")
cat("  \\includegraphics[width=0.7\\textwidth]{",
    "images/manuscript/supplement/Figure_S150.png}\n", sep = "")
cat("  \\caption{Abundance of the protein Angiotensinogen (AGT) in study ",
    "participants using hormonal contraceptives (HCU) and female and male ",
    "participants that don't.}\n",
    sep = "")
cat("\\end{figure}\n")

```


# Sex, age and body mass index associated proteins

## Sex-associated plasma proteins

```{r, echo = FALSE, message = FALSE, warning = FALSE, results = "asis"}
library(readxl)
library(pander)
results <- as.data.frame(read_xlsx(
    paste0("data/xlsx/sex_age_bmi_associated_proteins/",
           "results_sex_age_bmi_hcu_adjusted.xlsx")))
rownames(results) <- results$Uniprot

tab <- results[results$significant_SexFemale,
               c("Description", "Genes",
                 "coef_SexFemale",
                 "p.adj_SexFemale",
                 "Avg_Female",
                 "Avg_Male")]
tab <- tab[order(tab$p.adj_SexFemale), ]
colnames(tab) <- c("$Description$", "$Gene$", "$coef$", "$p_{adj}$",
                   "$A_{F}$", "$A_{M}$")
rownames(tab) <- NULL
pandoc.table(
    tab, split.table = "Inf", justify = "ccllll", keep.line.breaks = FALSE,
    split.cells = 50, style = "rmarkdown", digits = 3,
    caption = paste0(
        "Proteins with significant difference in abundance between female ",
        "and male study participants. $coef$ and $p_{adj}$: coefficient ",
        "(representing the differential abundance in log2 scale) and p-value ",
        "adjusted for multiple hypothesis testing. $A_{F}$ and $A_{M}$:",
        " average abundance in female and male participants, respectively. ",
        "Proteins are ordered by p-value."))

```


## Age-associated plasma proteins

```{r, echo = FALSE, message = FALSE, warning = FALSE, results = "asis"}
tab <- results[results$significant_Age,
               c("Description", "Genes",
                 "coef_Age",
                 "p.adj_Age",
                 "Avg_Female",
                 "Avg_Male")]
tab <- tab[order(tab$p.adj_Age), ]
colnames(tab) <- c("$Description$", "$Gene$", "$coef$", "$p_{adj}$",
                   "$A_{F}$", "$A_{M}$")
rownames(tab) <- NULL
pandoc.table(
    tab, split.table = "Inf", justify = "ccllll", keep.line.breaks = FALSE,
    split.cells = 50, style = "rmarkdown", digits = 3,
    caption = paste0(
        "Proteins significantly associated with participants' age. ",
        "$coef$ and $p_{adj}$: coefficient (representing the change in ",
        "abundance per year) and p-value adjusted for multiple hypothesis ",
        "testing. $A_{F}$ and $A_{M}$: average abundance in female and ",
        "male participants, respectively. ",
        "Proteins are ordered by p-value."))
```

## Body mass index associated plasma proteins

Proteins with significant differences in concentrations between body mass
index (BMI) categories 1 (BMI < 18.5), 3 (25 <= BMI < 30) and 4 (BMI > 30) to
the *normal* category 2 (18.5 <= BMI < 25) are listed in the tables
below. Proteins with an adjusted p-value smaller than 0.05 and a difference
in concentrations larger than the coefficient of variation in QC (study
pool) samples are considered significant.

```{r, echo = FALSE, message = FALSE, warning = FALSE, results = "asis"}
tab <- results[results$significant_BMIcat1,
               c("Description", "Genes",
                 "coef_BMIcat1",
                 "p.adj_BMIcat1",
                 "Avg_Female",
                 "Avg_Male")]
tab <- tab[order(tab$p.adj_BMIcat1), ]
colnames(tab) <- c("$Description$", "$Gene$", "$coef$", "$p_{adj}$",
                   "$A_{F}$", "$A_{M}$")
rownames(tab) <- NULL
pandoc.table(
    tab, split.table = "Inf", justify = "ccllll", keep.line.breaks = FALSE,
    split.cells = 50, style = "rmarkdown", digits = 3,
    caption = paste0(
        "Proteins with significant difference in abundance between ",
        "participants with a BMI < 18.5 (BMI1) and participants with a BMI ",
        "between 18.5 and 25 (BMI2; normal). ",
        "$coef$ and $p_{adj}$: coefficient (representing the differential ",
        "abundance in log2 scale) and p-value adjusted for multiple ",
        "hypothesis testing. $A_{F}$ and $A_{M}$:",
        " average abundance in female and male participants, respectively. ",
        "Proteins are ordered by p-value."))

```

```{r, echo = FALSE, message = FALSE, warning = FALSE, results = "asis"}
tab <- results[results$significant_BMIcat3,
               c("Description", "Genes",
                 "coef_BMIcat3",
                 "p.adj_BMIcat3",
                 "Avg_Female",
                 "Avg_Male")]
tab <- tab[order(tab$p.adj_BMIcat3), ]
colnames(tab) <- c("$Description$", "$Gene$", "$coef$", "$p_{adj}$",
                   "$A_{F}$", "$A_{M}$")
rownames(tab) <- NULL
pandoc.table(
    tab, split.table = "Inf", justify = "ccllll", keep.line.breaks = FALSE,
    split.cells = 50, style = "rmarkdown", digits = 3,
    caption = paste0(
        "Proteins with significant difference in abundance between ",
        "participants with a BMI between 25 and 30 (BMI3) and participants ",
        "with a BMI between 18.5 and 25 (BMI2; normal). ",
        "$coef$ and $p_{adj}$: coefficient (representing the differential ",
        "abundance in log2 scale) and p-value adjusted for multiple ",
        "hypothesis testing. $A_{F}$ and $A_{M}$:",
        " average abundance in female and male participants, respectively. ",
        "Proteins are ordered by p-value."))

```

```{r, echo = FALSE, message = FALSE, warning = FALSE, results = "asis"}
tab <- results[results$significant_BMIcat4,
               c("Description", "Genes",
                 "coef_BMIcat4",
                 "p.adj_BMIcat4",
                 "Avg_Female",
                 "Avg_Male")]
tab <- tab[order(tab$p.adj_BMIcat4), ]
colnames(tab) <- c("$Description$", "$Gene$", "$coef$", "$p_{adj}$",
                   "$A_{F}$", "$A_{M}$")
rownames(tab) <- NULL
pandoc.table(
    tab, split.table = "Inf", justify = "ccllll", keep.line.breaks = FALSE,
    split.cells = 50, style = "rmarkdown", digits = 3,
    caption = paste0(
        "Proteins with significant difference in abundance between ",
        "participants with a BMI > 30 (BMI4) and participants with a BMI ",
        "between 18.5 and 25 (BMI2; normal). ",
        "$coef$ and $p_{adj}$: coefficient (representing the differential ",
        "abundance in log2 scale) and p-value adjusted for multiple ",
        "hypothesis testing. $A_{F}$ and $A_{M}$:",
        " average abundance in female and male participants, respectively. ",
        "Proteins are ordered by p-value."))

```


# Plasma proteins associated with usage of hormonal contraceptives

```{r, echo = FALSE, message = FALSE, warning = FALSE, results = "asis"}
results_hcu <- as.data.frame(read_xlsx(
    paste0("data/xlsx/sex_age_bmi_associated_proteins/",
           "results_age_bmi_hcu_adjusted.xlsx")))
rownames(results_hcu) <- results_hcu$Uniprot

tab <- results_hcu[results_hcu$significant_HCUYes,
               c("Description", "Genes",
                 "coef_HCUYes",
                 "p.adj_HCUYes",
                 "effect_size_HCUYes")]
tab <- tab[order(tab$p.adj_HCUYes), ]
colnames(tab) <- c("$Description$", "$Gene$", "$coef$", "$p_{adj}$",
                   "$ES$")
rownames(tab) <- NULL
pandoc.table(
    tab, split.table = "Inf", justify = "cclll", keep.line.breaks = FALSE,
    split.cells = 50, style = "rmarkdown", digits = 3,
    caption = paste0(
        "Proteins with significant difference in abundance between female ",
        "study participants below 40 years of age that use or don't use ",
        "hormonal contraceptives.",
        " $coef$ and $p_{adj}$: coefficient (representing the differential ",
        "abundance in log2 scale) and p-value ",
        "adjusted for multiple hypothesis testing. $ES$ effect size. ",
        "Proteins are ordered by p-value."))

```

A comparison of the results from the analysis on the full data set and on the
subset of female participants below 40 years of age is shown below. Coefficients
for associations with hormonal contraceptive use are highly similar between the
two analyses and p-values highly related (same rank, but difference in the
values due to the differences in statistical power from the two analyses).

```{r, results = "asis"}
cat("\n\\begin{figure}[H]\n")
cat("\\centering\n")
cat("  \\includegraphics[width=0.9\\textwidth]{",
    "images/manuscript/supplement/Figure_S151.png}\n",
    sep = "")
cat("  \\caption{Comparison of results for association with hormonal ",
    "contraceptive use from the analysis of the full data set (x-axis) and ",
    "the analysis on the subset of female participants below 40 years ",
    "of age (y axis). Shown are -log10 of p-values, ranks of p-values and ",
    "coefficients.}\n",
    sep = "")
cat("\\end{figure}\n")

```


## Sensitivity analysis

To evaluate the influence of hormonal contraceptive use on results for age, sex
and BMI associations, the analysis was repeated without adjustment for hormonal
contraceptive use. Proteins that were found significantly associated with sex in
this analysis, but were no longer significant after adjustment for hormonal
contraceptive use are listed in the table below.

```{r, echo = FALSE, message = FALSE, warning = FALSE, results = "asis"}
a <- read_xlsx(
    "data/xlsx/sex_age_bmi_associated_proteins/sensitivity_sex.xlsx") |>
as.data.frame()

colnames(a) <- c("$Gene$", "$coef$", "$p$", "$coef_{adj}$",
                 "$p_{adj}$", "$coef_{HCU}$", "$p_{HCU}$")
rownames(a) <- NULL
pandoc.table(
    a, split.table = "Inf", justify = "cllllll", keep.line.breaks = FALSE,
    split.cells = 50, style = "rmarkdown", digits = 3,
    caption = paste0(
        "Proteins significantly associated with sex in an analysis without ",
        "adjusting for hormonal contraceptive use that were no longer ",
        "significant after adjustment. $coef$ and $p$: coefficient and ",
        "bonferroni adjusted p-value from the analysis without adjustment for ",
        "hormonal contraceptive use. $coef_{adj}$, $p_{adj}$, $coef_{HCU}$ ",
        "and $p_{HCU}$: coefficients and bonferroni adjusted p-values for ",
        "sex association and hormoman contraceptive use association from ",
        "the analysis with adjustment for hormonal contraceptive use."))

```

Proteins significantly associated with age from an analysis without adjustment
for hormonal contraceptive use that were no longer significant after adjustment
for hormonal contraceptive use are listed in the table below.

```{r, echo = FALSE, message = FALSE, warning = FALSE, results = "asis"}
b <- read_xlsx(
    "data/xlsx/sex_age_bmi_associated_proteins/sensitivity_age.xlsx") |>
as.data.frame()

colnames(b) <- c("$Gene$", "$coef$", "$p$", "$coef_{adj}$",
                 "$p_{adj}$", "$coef_{HCU}$", "$p_{HCU}$")
rownames(b) <- NULL
pandoc.table(
    b, split.table = "Inf", justify = "cllllll", keep.line.breaks = FALSE,
    split.cells = 50, style = "rmarkdown", digits = 3,
    caption = paste0(
        "Proteins significantly associated with age in an analysis without ",
        "adjusting for hormonal contraceptive use that were no longer ",
        "significant after adjustment. $coef$ and $p$: coefficient and ",
        "bonferroni adjusted p-value from the analysis without adjustment for ",
        "hormonal contraceptive use. $coef_{adj}$, $p_{adj}$, $coef_{HCU}$ ",
        "and $p_{HCU}$: coefficients and bonferroni adjusted p-values for ",
        "age association and hormonal contraceptive use association from ",
        "the analysis with adjustment for hormonal contraceptive use."))

```


# Extended Material and Methods

```{=latex}
\begin{table}[h!]
\caption{Set up for gradient separation (left) and wash and equilibration (right).}
\begin{tabular}{llll|llll}
\multicolumn{4}{c|}{Gradient pump} & \multicolumn{4}{c}{Regeneration pump} \\ \hline
Time  & \%A & \%B & FR {[}ml/mn{]} & Time  & \%A  & \%B  & FR {[}ml/mn{]}  \\
0     & 97  & 3   & 0.8            & 0     & 97   & 3    & 0.8             \\
0.7   & 20  & 80  & 1              & 5     & 65   & 35   & 0.8             \\
1.5   & 20  & 80  & 1              & 5.05  & 97   & 3    & 1               \\
2     & 97  & 3   & 1              & 5.75  & 97   & 3    & 1               \\
5     & 97  & 3   & 1              & 5.8   & 97   & 3    & 0.8             \\
5.2   & 97  & 3   & 0.8            &       &      &      &
\end{tabular}
\end{table}
```
